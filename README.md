# 1C.EDS.RulesForDataExchangeKR
#### Правила обмена данными (Королев<->Реутов)
---
Обмен базируется на механизмах подсистемы [1С:Библиотека стандартных подсистем ](http://v8.1c.ru/libraries/ssl/index.htm)  (версия 2.3.4.14)

#### Правила регистрации объектов узла Королев
```javascript
===ДокументСсылка.УКЕДС_Заявки===
УКЖКХ_АдресАЗ.Владелец.ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов
И
УКЖКХ_Адрес.Владелец.ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов
И
Исполнитель.ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов

===СправочникСсылка.УКЖКХ_АдресныйФонд===
ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов

===СправочникСсылка.УКЖКХ_АдресныйРеестр===
Владелец.ТерриториальноеПодразделение = ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов

===СправочникСсылка.УКЕДС_ЗаявкиИсполнители===
ТерриториальноеПодразделение = Перечисления.УКНСИ_ТерриториальныеПодразделения.Реутов

```

#### Правила обмена данными Королев -> Реутов

+ `Выгрузка данных`

> -Константа.ЕДС_СведенияПоЗадолженностиРеутовсведения - актуальная дата сведений по задолженности г.Реутов;
> -Справочник.УКЖКХ_АдресныйФонд;
> -Справочник.УКЖКХ_АдресныйРеестр;
> -Справочник.УКЕДС_ЗаявкиИсполнители;
> -Документ.УКЕДС_Заявки;

+ `Загрузка Данных`

> -программно создаем записи РегистрыСведений.ЕДСК_СоответствиеТематики для новых тематикобновляем константу; ЕДС_СведенияПоЗадолженностиРеутов актуальной датой сведений по задолженности;
> -очищаем сведения по задолженности за ранние периоды (храним только актуальные сведения);

+ `Особенности правил`

Виды заявок переносятся по таблице кодов. "Плановое ХХ категория" превращается в "Коммерческая", если ПричинаСобытия заявки относится к коммерческим отключениям.
Для тематики, которая не расписана по таблице соответствий между узлами, программно создается запись в РегистрыСведений.ЕДСК_СоответствиеТематики. Для новых тематик по отключениям ресурсов необходимо вручную создать 2 записи в данном регистре сведений (измерение ЭтоСобытиеПоЧастиЗдания).

#### Правила обмена данными Реутов -> Королев

+ `Выгрузка данных`

> -программно выгружаем сведения по задолженности в разрезе адресов помещений;

+ `Загрузка Данных`

> -программно обновляем константу ЕДС_СведенияПоЗадолженностиРеутов актуальной датой сведений по задолженности;
> -очищаем сведения по задолженности за ранние периоды (храним только актуальные сведения)

+ `Особенности правил`

Заглушка в ПВД УКЖКХ_АдресныйФонд - фиктивное ПВД для штатного функционирования механизма обмена
```javascript
#Событие "Перед обработкой"
Отказ = Истина;
```
